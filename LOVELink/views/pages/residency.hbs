<!-- residency.hbs -->
<div class="residency-page">
  {{> navbar activePage="residency" }}

  <div class="main-content-wrapper">
    <!-- Left Column (Avatar, Button, QR) -->
    <div class="left-column">
      <div class="user-avatar-wrapper">
        <img class="user-avatar" src="/images/user.png" alt="User" />
      </div>

      <!-- Log Residency Button (Link to logged-in page) -->
      <a href="/residency-logged-in" class="update-btn-wrapper">
        <div class="update-btn-text">Log Residency</div>
      </a>

      <!-- QR Code -->
      <div class="qr-code-wrapper">
        <img class="qr-img" src="{{qrCode}}" alt="QR Code" />
      </div>
    </div>

    <!-- Right Column (Name, Date, Table, Buttons) -->
    <div class="right-column">
      <!-- Name -->
      <div class="profile-name">
        {{firstName}} {{lastName}} <span class="italic">({{committee}})</span>
      </div>

      <!-- Timestamp -->
      <div class="current-timestamp" id="timestamp">
        Today is ...
      </div>

      <!-- Previous Residency Table -->
      <div class="residency-table-wrapper">
        <div class="table-header">Previous Residency</div>
        <div class="table-content">
          <div class="table-row">
            <strong>Time in:</strong> {{latestTimeIn}}
          </div>
          <div class="table-row">
            <strong>Time out:</strong> {{latestTimeOut}}
          </div>
          <div class="table-row">
            <strong>Total:</strong> {{duration}}
          </div>
        </div>
      </div>

      <!-- History Buttons -->
      <div class="history-buttons center-buttons">
        <div class="secondary"></div>


  <script>
  function updateTimestamp() {
    // Create a new Date and convert to UTC+8 (Philippine Time)
    const now = new Date();
    const options = {
      timeZone: 'Asia/Manila',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      hour12: false,
    };

    const formatter = new Intl.DateTimeFormat('en-PH', options);
    document.getElementById('timestamp').innerText = `Today is ${formatter.format(now)}`;
  }

  // Update once immediately
  updateTimestamp();

  // Then update every second
  setInterval(updateTimestamp, 1000);
  </script>
